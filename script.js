"use strict";function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw s}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var GP_Buttons={};function GP_checkAll(){var e,t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],n=Date.now(),a=_createForOfIteratorHelper(t);try{var r=function(){var t=e.value;t&&t.buttons.forEach((function(e,a){var r="GP"+t.index+"-"+GP_idToText(a);GP_Buttons.hasOwnProperty(r)&&(GP_Buttons[r].updated=n,GP_Buttons[r].pressed=e.pressed,e.pressed?GP_Buttons[r].held+=listeningRate:(GP_Buttons[r].released=GP_Buttons[r].held,GP_Buttons[r].held=0))}))};for(a.s();!(e=a.n()).done;)r()}catch(e){a.e(e)}finally{a.f()}}function GP_registerNewButtons(){var e,t=_createForOfIteratorHelper(navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[]);try{var n=function(){var t=e.value;t&&t.buttons.forEach((function(e,n){if(e.pressed){var a="GP"+t.index+"-"+GP_idToText(n);GP_Buttons.hasOwnProperty(a)||(GP_Buttons[a]={},GP_Buttons[a].state="",GP_Buttons[a].saved="",GP_Buttons[a].updated="YET TO BE UPDATED",GP_Buttons[a].honk="",GP_Buttons[a].pressed=!1,GP_Buttons[a].held=0,GP_Buttons[a].released=0,GP_Buttons[a].element=duocument.getElementById("sampleButton").cloneNode(!0),GP_Buttons[a].element.id=a,document.getElementById("notification").append(GP_Buttons[a].element),console.log("Registered: "+a))}}))};for(t.s();!(e=t.n()).done;)n()}catch(e){t.e(e)}finally{t.f()}}function GP_vibrate_connect(e){GP_vibrate(e,300,.5,.5).then((function(){return wait(100)})).then((function(){return GP_vibrate(e,300,.5,.1)}))}function GP_vibrate(e,t,n,a){return new Promise((function(r,s){null!=e.vibrationActuator&&e.vibrationActuator.playEffect("dual-rumble",{duration:t,weakMagnitude:n,strongMagnitude:a}),setTimeout(r,t)}))}function GP_idToText(e){var t="Button not found";switch(e){case 0:t="X";break;case 1:t="○";break;case 2:t="□";break;case 3:t="△";break;case 4:t="L1";break;case 5:t="R1";break;case 6:t="L2";break;case 7:t="R2";break;case 8:t="SHARE";break;case 9:t="OPTION";break;case 10:t="L3";break;case 11:t="R3";break;case 12:t="⇧";break;case 13:t="⇩";break;case 14:t="⇦";break;case 15:t="⇨";break;case 16:t="㎰";break;case 17:t="▨"}return t}function ready(e){"loading"!==document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&e()}))}function wait(e){return new Promise((function(t){setTimeout(t,e)}))}function fadeIn(e,t){return new Promise((function(n){e.animate({opacity:[0,1]},{duration:t,fill:"both"}),setTimeout(n,t)}))}function fadeOut(e,t){return new Promise((function(n){e.animate({opacity:[1,0]},{duration:t,fill:"both"}),setTimeout(n,t)}))}function updateButton(e,t){var n=1e3;if(e.pressed){var a=e.held%1500,r=e.held%(1500*t.length),s=Math.floor(r/1500),o=(s+1)%t.length;a<n?(e.element.querySelector(".text").innerHTML=t[s],e.element.querySelector(".subtext").innerHTML=t[o]):e.element.querySelector(".text").innerHTML=" "}else if(e.element.querySelector(".text").innerHTML=" ",e.element.querySelector(".subtext").innerHTML=" ",e.released>0){var c=e.released%1500,l=e.released%(1500*t.length),i=Math.floor(l/1500);c<n&&(e.state=t[i])}}ready((function(){window.addEventListener("gamepadconnected",(function(e){var t=e.gamepad;console.log("Gamepad connected: "+t.id),GP_vibrate_connect(t)})),window.addEventListener("gamepaddisconnected",(function(e){var t=e.gamepad;console.log("Gamepad disconnected: "+t.id)}))}));var keyPressHandler={};function clearKeyPressHandler(){for(var e in keyPressHandler)keyPressHandler[e]=void 0}function searchKeyEnter(){clearKeyPressHandler(),search(document.getElementById("searchInput").value);var e=document.getElementById("search");fadeOut(e,500).then((function(){e.style.display="none",startSelect()}))}function selectKeyLeft(){var e=document.getElementById("searchResults");if(e.querySelector(".selected")){var t=parseInt(e.querySelector(".selected").id);if(t>0){e.querySelector("[id='".concat(t,"']")).classList.remove("selected");var n=t-1;e.querySelector("[id='".concat(n,"']")).classList.add("selected")}}else e.querySelector("[id='0']").classList.add("selected")}function selectKeyRight(){var e=document.getElementById("searchResults");if(e.querySelector(".selected")){var t=parseInt(e.querySelector(".selected").id);if(t<e.querySelectorAll(".thumb").length-1){e.querySelector("[id='".concat(t,"']")).classList.remove("selected");var n=t+1;e.querySelector("[id='".concat(n,"']")).classList.add("selected")}}else e.querySelector("[id='0']").classList.add("selected")}function selectKeyBack(){clearKeyPressHandler(),document.getElementById("searchInput").value="";var e=document.getElementById("select");fadeOut(e,500).then((function(){e.style.display="none",startSearch()}))}function selectKeyEnter(){clearKeyPressHandler(),YT_playlist(document.querySelector(".selected").getAttribute("data-playlistId")),YT_shuffle();var e=document.getElementById("select");fadeOut(e,500).then((function(){e.style.display="none",startRegister()}))}function registerKeyBack(){for(var e in clearKeyPressHandler(),clearInterval(listeningInterval),GP_Buttons)delete GP_Buttons[e];document.getElementById("notification").replaceChildren(),document.getElementById("searchInput").value="";var t=document.getElementById("register");fadeOut(t,500).then((function(){t.style.display="none",startSearch()}))}ready((function(){document.addEventListener("keydown",(function(e){e.repeat||(void 0!==keyPressHandler[e.key]?keyPressHandler[e.key]():console.log("Untracked key press:  ".concat(e.key," (").concat(e.code,")")))}))}));var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var player,listeningInterval,firstScriptTag=document.getElementsByTagName("script")[0];function onYouTubeIframeAPIReady(){player=new YT.Player("player",{height:.98*$(window).height,width:.98*$(window).width,playerVars:{controls:0,showinfo:0,fs:0,iv_load_policy:3,modestbranding:1,origin:"http://localhost:3000",rel:0},videoId:"wUF9DeWJ0Dk",events:{onReady:YT_onPlayerReady,onStateChange:YT_onPlayerStateChange}})}function YT_onPlayerReady(e){}function YT_onPlayerStateChange(e){console.log(e.data)}function YT_shuffle(){player.setShuffle(!0)}function YT_stop(){player.stopVideo()}function YT_start(){player.playVideo()}function YT_playlist(e){player.cuePlaylist({list:e})}function YT_skip(){player.nextVideo()}firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var listeningRate=100,colours=["red","orange","yellow","green","blue","purple","white"];function startSplash(){var e=document.getElementById("splash");e.style.display="flex",fadeIn(e,500).then((function(){return wait(1e3)})).then((function(){return fadeOut(e,500)})).then((function(){e.style.display="none",startSearch()}))}function startSearch(){var e=document.getElementById("search");e.style.display="flex",document.getElementById("searchInput").focus(),fadeIn(e,500),keyPressHandler.Enter=function(){return searchKeyEnter()}}function startSelect(){var e=document.getElementById("select");e.style.display="flex",fadeIn(e,500),keyPressHandler.Enter=function(){return selectKeyEnter()},keyPressHandler[" "]=function(){return selectKeyEnter()},keyPressHandler.Backspace=function(){return selectKeyBack()},keyPressHandler.Escape=function(){return selectKeyBack()},keyPressHandler.ArrowLeft=function(){return selectKeyLeft()},keyPressHandler.ArrowRight=function(){return selectKeyRight()}}function startRegister(){var e=document.getElementById("register");e.style.display="flex",fadeIn(e,500),listeningInterval=setInterval((function(){GP_registerNewButtons(),GP_checkAll();var t=!0;for(var n in 0===Object.keys(GP_Buttons).length&&(t=!1),GP_Buttons){var a=GP_Buttons[n];switch(updateButton(a,["Honk!!","Ready","Remove","New Colour","New Honk"]),"Ready"!=a.state&&(t=!1),a.state){case"Honk!!":case"New Honk":a.state="";break;case"Remove":a.element.remove(),delete GP_Buttons[n];break;case"New Colour":a.state="";var r=colours[Math.floor(Math.random()*colours.length)];a.element.querySelector(".button").style.background=r,a.element.querySelector(".button_icon").style.color=r}}t&&(clearInterval(listeningInterval),fadeOut(e,500).then((function(){e.style.display="none",startPlay()})))}),listeningRate),keyPressHandler.Backspace=function(){return registerKeyBack()},keyPressHandler.Escape=function(){return registerKeyBack()}}function startPlay(){document.body.classList.add("black");var e=document.getElementById("play");for(var t in e.style.display="flex",fadeIn(e,500).then((function(){YT_start()})),GP_Buttons)GP_Buttons[t].state=GP_Buttons[t].saved;listeningInterval=setInterval((function(){GP_checkAll();var e=!0;for(var t in 0===Object.keys(GP_Buttons).length&&(e=!1),GP_Buttons){var n=GP_Buttons[t];switch("Skip"==n.state||"Super Skip"==n.state?updateButton(n,["Super Skip","Let It Play","Pause..."]):(e=!1,updateButton(n,["Skip","Love This!!","Pause"])),n.state){case"Skip":break;case"Super Skip":case"Pause...":n.state="Skip";break;case"Love This!!":case"Pause":n.state="";break;case"Let It Play":e=!1,n.state=""}}if(e){for(var a in GP_Buttons)GP_Buttons[a].state="";YT_skip()}}),listeningRate)}ready((function(){startSplash()}));var apiKey="AIzaSyCniO30nub42x6lHMjjSo4FirgYKScZJLo";function search(e){$("#searchResults").text("loading..."),$.getJSON("https://www.googleapis.com/youtube/v3/search?part=snippet&type=playlist&maxResults=5&key="+apiKey+"&q="+e,(function(e){$("#searchResults").empty(),e.items.forEach((function(e,t){$("#searchResults").append($("#sampleThumb").clone().attr("id",t).attr("data-playlistId",e.id.playlistId).mouseover((function(){$(".selected").removeClass("selected"),$(this).addClass("selected")})).mouseout((function(){$(this).removeClass("selected")})).click((function(){return selectKeyEnter()}))),$(".thumb#"+t+" img").attr("src",e.snippet.thumbnails.default.url),$(".thumb#"+t+" p").text(e.snippet.title)})),$(".thumb#0").addClass("selected")}))}